<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Search Results</title>
    <link rel="stylesheet" href="assets/css/universal_styles.css">
</head>
<body>

<h1>Search Results</h1>
<div id="results"></div>

<script src="assets/javascript/universal.js"></script>
<script>
async function loadSearchResults() {
    const params = new URLSearchParams(window.location.search);
    const query = params.get("q")?.toLowerCase() || "";

    const resultsContainer = document.getElementById("results");

    if (!query) {
        resultsContainer.innerHTML = "<p>No search query provided.</p>";
        return;
    }

    const response = await fetch("/assets/json/search_index.json");
    const pages = await response.json();

    const matches = pages.filter(page =>
        page.content.toLowerCase().includes(query)
    );

    if (matches.length === 0) {
        resultsContainer.innerHTML = "<p>No results found.</p>";
        return;
    }

    resultsContainer.innerHTML = matches.map(page => `
        <div class="search-result">
            <h2><a href="${page.url}">${page.title}</a></h2>
            <p>${page.content.substring(0, 200)}...</p>
        </div>
    `).join("");
}

loadSearchResults();
</script>

</body>
</html>
